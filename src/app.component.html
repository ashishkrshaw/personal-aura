<div class="h-screen w-screen flex flex-col bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-100 relative overflow-hidden">

  @if (isAuthenticated()) {
    @if (showSplash()) {
      <div 
        id="splash-screen" 
        class="absolute inset-0 bg-white dark:bg-gray-900 flex flex-col items-center justify-center z-50 transition-opacity duration-500 ease-in-out"
        [class.opacity-0]="!isInitializing()">
        <div class="text-center">
          <div class="w-24 h-24 mb-4">
            <svg width="96" height="96" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg" class="animate-pulse">
              <defs>
                <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
                  <feGaussianBlur stdDeviation="2" result="coloredBlur"/>
                  <feMerge>
                    <feMergeNode in="coloredBlur"/>
                    <feMergeNode in="SourceGraphic"/>
                  </feMerge>
                </filter>
                <radialGradient id="grad" cx="50%" cy="50%" r="50%" fx="30%" fy="30%">
                  <stop offset="0%" stop-color="#E9D5FF"/>
                  <stop offset="100%" stop-color="#A855F7"/>
                </radialGradient>
              </defs>
              <circle cx="24" cy="24" r="18" fill="url(#grad)" filter="url(#glow)"/>
            </svg>
          </div>
          <p class="mt-2 text-gray-500 dark:text-gray-400">Your Personal AI Assistant</p>
        </div>
      </div>
    }

    <header class="p-4 bg-gray-50/80 dark:bg-gray-800/50 backdrop-blur-sm border-b border-gray-200 dark:border-gray-700 shadow-sm flex justify-between items-center">
      <div class="flex items-center gap-3">
        <div 
          class="w-2.5 h-2.5 rounded-full"
          [class]="{
            'bg-green-400 animate-pulse': dataService.backendStatus() === 'online',
            'bg-yellow-400': dataService.backendStatus() === 'checking',
            'bg-red-500': dataService.backendStatus() === 'offline'
          }"
          [title]="'Backend status: ' + dataService.backendStatus()">
        </div>
        <svg width="32" height="32" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
          <defs><radialGradient id="gradHeader" cx="50%" cy="50%" r="50%" fx="30%" fy="30%"><stop offset="0%" stop-color="#E9D5FF"/><stop offset="100%" stop-color="#A855F7"/></radialGradient></defs>
          <circle cx="24" cy="24" r="16" fill="url(#gradHeader)"/>
        </svg>
        <h1 class="text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-500 to-blue-500">
          AURA
        </h1>
      </div>
      <button (click)="themeService.toggleTheme()" class="w-10 h-10 flex items-center justify-center rounded-full bg-gray-200 dark:bg-gray-700 text-gray-500 dark:text-gray-400 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">
        <i class="fas" [class]="themeService.theme() === 'dark' ? 'fa-sun' : 'fa-moon'"></i>
      </button>
    </header>

    <main class="flex-grow overflow-y-auto p-4 fade-in">
      @switch (activeTab()) {
        @case ('coach') {
          <app-people-coach />
        }
        @case ('navigate') {
          <app-location-helper />
        }
        @case ('create') {
          <app-creative-suite />
        }
        @case ('career') {
          <app-career-assistant />
        }
        @case ('chat') {
          <app-chatbot />
        }
        @case ('live') {
          <app-live-conversation />
        }
      }
    </main>

    <nav class="flex justify-around p-1 bg-gray-50/80 dark:bg-gray-800/50 backdrop-blur-sm border-t border-gray-200 dark:border-gray-700">
      @for(tab of tabs; track tab.id) {
        <button 
          (click)="selectTab(tab.id)"
          [class]="'flex-1 flex flex-col items-center justify-center p-2 rounded-lg transition-all duration-300 ' + (activeTab() === tab.id ? 'text-purple-500 bg-purple-100 dark:bg-gray-700 scale-110' : 'text-gray-500 dark:text-gray-400 hover:bg-gray-200/50 dark:hover:bg-gray-700/50 hover:text-purple-500 dark:hover:text-purple-300')">
          <i [class]="'fas ' + tab.icon + ' text-xl'"></i>
          <span class="text-xs mt-1 font-medium">{{ tab.name }}</span>
        </button>
      }
    </nav>
  } @else {
    <app-login (loginSuccess)="handleLoginSuccess()"></app-login>
  }
</div>